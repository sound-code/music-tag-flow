<!DOCTYPE html>
<html>
<head>
    <title>Test SimpleLegendService</title>
    <style>
        .color-legend {
            width: 300px;
            margin: 20px;
            padding: 10px;
            border: 1px solid #ccc;
        }
        .legend-category-box {
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .legend-category-header {
            padding: 8px;
            background: #f5f5f5;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
        .legend-tags-list {
            padding: 8px;
            background: white;
        }
        .legend-tag-item {
            display: inline-block;
            background: #e9ecef;
            padding: 2px 6px;
            margin: 2px;
            border-radius: 3px;
            font-size: 12px;
            cursor: pointer;
        }
        .legend-tag-item:hover {
            background: #dee2e6;
        }
        .legend-tag-item.clicked {
            background: #007bff;
            color: white;
        }
    </style>
</head>
<body>
    <h1>SimpleLegendService Test</h1>
    <div class="color-legend">
        <h4>Tag Categories</h4>
    </div>
    
    <div id="output"></div>

    <!-- Load dependencies -->
    <script src="js/utils/TagUtils.js"></script>
    <script src="js/dataSourceAdapter.js"></script>
    <script src="js/core/SimpleLegendService.js"></script>
    
    <script>
        console.log('üß™ Starting SimpleLegendService test...');
        
        // Mock DataSourceAdapter for testing
        window.DataSourceAdapter = {
            async getTagsByCategory() {
                // Return mock data for testing
                return {
                    emotion: ['happy', 'sad', 'energetic'],
                    energy: ['high', 'medium', 'low'],
                    format: ['flac', 'mp3'],
                    other: ['ffprobe', '320k', 'lossless']
                };
            }
        };
        
        // Initialize and test
        async function testLegend() {
            try {
                console.log('üß™ Creating SimpleLegendService...');
                const legendService = new SimpleLegendService();
                
                console.log('üß™ Initializing SimpleLegendService...');
                await legendService.initialize();
                
                console.log('üß™ Legend service initialized successfully!');
                
                // Test output
                const output = document.getElementById('output');
                output.innerHTML = '<p style="color: green;">‚úÖ SimpleLegendService test completed successfully!</p>';
                
            } catch (error) {
                console.error('üß™ Test failed:', error);
                const output = document.getElementById('output');
                output.innerHTML = `<p style="color: red;">‚ùå Test failed: ${error.message}</p>`;
            }
        }
        
        // Wait for DOM and run test
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', testLegend);
        } else {
            testLegend();
        }
    </script>
</body>
</html>